<!DOCTYPE html>
<html lang="en">

<head>
	<title>UDDI Chat</title>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		body {
			display: flex;
			flex-direction: column;
			height: 100vh;
			background: #1a1a1a;
			color: #fff;
			font-family: 'Arial', 'Helvetica Neue', sans-serif;
		}

		iframe {
			flex: 1;
			border: none;
			width: 100%;
		}

		#chat-bar {
			display: flex;
			padding: 8px;
			background: #2a2a2a;
			border-top: 1px solid #444;
		}

		#chat-bar input {
			flex: 1;
			padding: 8px 12px;
			border: 1px solid #444;
			border-radius: 4px;
			background: #333;
			color: #fff;
			font-size: 14px;
			outline: none;
		}

		#chat-bar input:focus {
			border-color: #666;
		}

		#chat-bar button {
			margin-left: 8px;
			padding: 8px 16px;
			border: none;
			border-radius: 4px;
			background: #5865f2;
			color: #fff;
			font-size: 14px;
			cursor: pointer;
		}

		#chat-bar button:hover {
			background: #4752c4;
		}
	</style>
</head>

<body>
	<iframe src="overlay.html"></iframe>
	<div id="chat-bar">
		<input id="msg" type="text" placeholder="Type a message..." autocomplete="off"/>
		<button id="send">Send</button>
	</div>
</body>

<script>
	const input = document.getElementById("msg");
	const sendBtn = document.getElementById("send");

	const ws = new WebSocket(`${location.protocol === "https:" ? "wss:" : "ws:"}//${location.host}/ws`);

	ws.addEventListener("open", () => {
		console.log("Connected to UDDI server");
	});

	function send() {
		const text = input.value.trim();
		if (text && ws.readyState === WebSocket.OPEN) {
			ws.send(text);
			input.value = "";
		}
		input.focus();
	}

	sendBtn.addEventListener("click", send);
	input.addEventListener("keydown", (e) => {
		if (e.key === "Enter") send();
	});
</script>

</html>
